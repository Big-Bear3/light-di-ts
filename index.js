/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(()=>(()=>{var e={660:(e,t,n)=>{var r;!function(e){!function(t){var r="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=i(e);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:s=i(r.Reflect,s),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,a={__proto__:[]}instanceof Array,o=!i&&!a,c={create:i?function(){return R(Object.create(null))}:a?function(){return R({__proto__:null})}:function(){return R({})},has:o?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:o?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,s=n+1;s<r;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}():Map,p=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}():Set,h=new(l||"function"!=typeof WeakMap?function(){var e=c.create(),n=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var t;do{t="@@WeakMap@@"+a()}while(c.has(e,t));return e[t]=!0,t}function s(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function i(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):i(new Uint8Array(e),e):i(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<16;++r){var s=t[r];4!==r&&6!==r&&8!==r||(n+="-"),s<16&&(n+="0"),n+=s.toString(16).toLowerCase()}return n}}():WeakMap);function d(e,t,n){var r=h.get(e);if(D(r)){if(!n)return;r=new f,h.set(e,r)}var s=r.get(t);if(D(s)){if(!n)return;s=new f,r.set(t,s)}return s}function y(e,t,n){if(g(e,t,n))return!0;var r=N(t);return!C(r)&&y(e,r,n)}function g(e,t,n){var r=d(t,n,!1);return!D(r)&&!!r.has(e)}function m(e,t,n){if(g(e,t,n))return b(e,t,n);var r=N(t);return C(r)?void 0:m(e,r,n)}function b(e,t,n){var r=d(t,n,!1);if(!D(r))return r.get(e)}function w(e,t,n,r){d(n,r,!0).set(e,t)}function v(e,t){var n=_(e,t),r=N(e);if(null===r)return n;var s=v(r,t);if(s.length<=0)return n;if(n.length<=0)return s;for(var i=new p,a=[],o=0,c=n;o<c.length;o++){var u=c[o];i.has(u)||(i.add(u),a.push(u))}for(var l=0,f=s;l<f.length;l++)u=f[l],i.has(u)||(i.add(u),a.push(u));return a}function _(e,t){var n=[],r=d(e,t,!1);if(D(r))return n;for(var i=function(e){var t=T(e,s);if(!E(t))throw new TypeError;var n=t.call(e);if(!I(n))throw new TypeError;return n}(r.keys()),a=0;;){var o=x(i);if(!o)return n.length=a,n;var c=o.value;try{n[a]=c}catch(e){try{P(i)}finally{throw e}}a++}}function M(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function D(e){return void 0===e}function C(e){return null===e}function I(e){return"object"==typeof e?null!==e:"function"==typeof e}function k(e,t){switch(M(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",s=T(e,r);if(void 0!==s){var i=s.call(e,n);if(I(i))throw new TypeError;return i}return function(e,t){if("string"===t){var n=e.toString;if(E(n)&&!I(s=n.call(e)))return s;if(E(r=e.valueOf)&&!I(s=r.call(e)))return s}else{var r;if(E(r=e.valueOf)&&!I(s=r.call(e)))return s;var s,i=e.toString;if(E(i)&&!I(s=i.call(e)))return s}throw new TypeError}(e,"default"===n?"number":n)}function j(e){var t=k(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function O(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function E(e){return"function"==typeof e}function S(e){return"function"==typeof e}function T(e,t){var n=e[t];if(null!=n){if(!E(n))throw new TypeError;return n}}function x(e){var t=e.next();return!t.done&&t}function P(e){var t=e.return;t&&t.call(e)}function N(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var s=r.constructor;return"function"!=typeof s||s===e?t:s}function R(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,n,r){if(D(n)){if(!O(e))throw new TypeError;if(!S(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!D(r)&&!C(r)){if(!S(r))throw new TypeError;t=r}}return t}(e,t)}if(!O(e))throw new TypeError;if(!I(t))throw new TypeError;if(!I(r)&&!D(r)&&!C(r))throw new TypeError;return C(r)&&(r=void 0),function(e,t,n,r){for(var s=e.length-1;s>=0;--s){var i=(0,e[s])(t,n,r);if(!D(i)&&!C(i)){if(!I(i))throw new TypeError;r=i}}return r}(e,t,n=j(n),r)})),e("metadata",(function(e,t){return function(n,r){if(!I(n))throw new TypeError;if(!D(r)&&!function(e){switch(M(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;w(e,t,n,r)}})),e("defineMetadata",(function(e,t,n,r){if(!I(n))throw new TypeError;return D(r)||(r=j(r)),w(e,t,n,r)})),e("hasMetadata",(function(e,t,n){if(!I(t))throw new TypeError;return D(n)||(n=j(n)),y(e,t,n)})),e("hasOwnMetadata",(function(e,t,n){if(!I(t))throw new TypeError;return D(n)||(n=j(n)),g(e,t,n)})),e("getMetadata",(function(e,t,n){if(!I(t))throw new TypeError;return D(n)||(n=j(n)),m(e,t,n)})),e("getOwnMetadata",(function(e,t,n){if(!I(t))throw new TypeError;return D(n)||(n=j(n)),b(e,t,n)})),e("getMetadataKeys",(function(e,t){if(!I(e))throw new TypeError;return D(t)||(t=j(t)),v(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!I(e))throw new TypeError;return D(t)||(t=j(t)),_(e,t)})),e("deleteMetadata",(function(e,t,n){if(!I(t))throw new TypeError;D(n)||(n=j(n));var r=d(t,n,!1);if(D(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var s=h.get(t);return s.delete(n),s.size>0||h.delete(t),!0}))}(s)}()}(r||(r={}))}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{AUTO:()=>B,DependencyConfig:()=>A,Inject:()=>K,Injectable:()=>R,MODULE:()=>F,MushroomService:()=>z,STOP_DEEP_CONFIG:()=>$,by:()=>T,of:()=>S,registerDepsConfig:()=>V,req:()=>x,setAsDependencyConfig:()=>N,setAsInjectable:()=>P}),n(660);const e={type:"multiple"},t={lazy:!1},s=Symbol("DI-AUTO"),i=Symbol("DI-STOP-DEEP-CONFIG"),a=Symbol("DI-VALUE-DEPS-MODULE");class o{constructor(){this.dependenciesMap=new Map}collect(e,t){this.dependenciesMap.set(e,t)}getInjectableOptions(t){const n=this.dependenciesMap.get(t);return n?(n.type||(n.type=e.type),n):e}contains(e){return this.dependenciesMap.has(e)}static get instance(){return o._instance||(o._instance=new o),o._instance}}class c{static{this.consolePrintable=!0}static{this.histories=[]}static warn(e,t){c.histories.push({type:"warn",code:e,message:t}),c.consolePrintable&&console.warn(`(${e}) ${t}`)}static error(e,t){c.histories.push({type:"error",code:e,message:t}),c.consolePrintable&&console.error(`(${e}) ${t}`)}static throwError(e,t){throw c.histories.push({type:"throw",code:e,message:t}),c.consolePrintable?new Error(`(${e}) ${t}`):new Error}static getHistory(){return c.histories}static clearHistory(){c.histories.splice(0)}static toggleConsolePrintable(e){c.consolePrintable=e}}class u{constructor(){this.dependenciesConfigMap=new Map,this.dependenciesSymbolConfigMap=new Map}collect(e,t){"symbol"==typeof e?(this.dependenciesSymbolConfigMap.has(e)&&c.warn("20004",`您在多处进行了 "${e.toString()}" 的依赖配置！`),this.dependenciesSymbolConfigMap.set(e,t)):(this.dependenciesConfigMap.has(e)&&c.warn("20003",`您在多处进行了 "${e.name}" 的依赖配置！`),this.dependenciesConfigMap.set(e,t))}getConfigMethod(e){return"symbol"==typeof e?this.dependenciesSymbolConfigMap.get(e):this.dependenciesConfigMap.get(e)}static get instance(){return u._instance||(u._instance=new u),u._instance}}class l{constructor(e,t){this.usingClass=e,this.args=t,this.afterInstanceCreate=void 0,this.afterInstanceFetch=void 0}}class f{constructor(){this.singletonDependenciesMap=new Map}addDependency(e,t){this.singletonDependenciesMap.set(e,t)}getDependency(e){return this.singletonDependenciesMap.get(e)}removeDependency(e){return this.singletonDependenciesMap.delete(e)}static get instance(){return f._instance||(f._instance=new f),f._instance}}class p{constructor(){}addNodeAndCheckRing(e,t){if(!t)return this.initialNode=new h(e),this.valueToNode=new Map,void this.valueToNode.set(e,this.initialNode);const n=this.valueToNode.get(t);let r=this.valueToNode.get(e);return r?(n.addNextNode(r),this.checkRing(r)):(r=new h(e),n.addNextNode(r),void this.valueToNode.set(r.value,r))}checkRing(e){const t=[{value:e,path:[e.value]}];let n=!0;for(;t.length>0;){const r=t.pop();if(!n&&r.value===e)return r.path;if(r.value.nextNodesCount()>0){const e=[];for(const t of r.value.nextNodes)e.push({value:t,path:[...r.path,t.value]});t.unshift(...e)}n&&(n=!1)}}}class h{constructor(e){this.value=e}addNextNode(e){this.nextNodes||(this.nextNodes=new Set),this.nextNodes.add(e)}nextNodesCount(){return this.nextNodes?this.nextNodes.size:0}}class d{constructor(){this.classToInjectMembers=new Map,this.instanceToLazyInjectMembers=new WeakMap}addInjectMember(e,n,r,s=t){const i=this.classToInjectMembers.get(e);i?s.lazy?i.lazyMembers.push({memberName:n,definedClassOrSymbol:r}):i.members.push({memberName:n,definedClassOrSymbol:r}):s.lazy?this.classToInjectMembers.set(e,{members:[],lazyMembers:[{memberName:n,definedClassOrSymbol:r}],lazyMembersHandled:!1}):this.classToInjectMembers.set(e,{members:[{memberName:n,definedClassOrSymbol:r}],lazyMembers:[],lazyMembersHandled:!1})}handleInstanceMembers(e,t){const n=this.classToInjectMembers.get(e.prototype);if(n){const e=m.instance;for(const r of n.members)"symbol"==typeof r.definedClassOrSymbol?t[r.memberName]=e.searchDependencyBySymbol(r.definedClassOrSymbol):t[r.memberName]=e.searchDependencyByClass(r.definedClassOrSymbol)}const r=Object.getPrototypeOf(e);r&&this.handleInstanceMembers(r,t)}handleInstanceLazyMembers(e){const t=this.classToInjectMembers.get(e.prototype);if(t&&!t.lazyMembersHandled){const n=m.instance,r=this.instanceToLazyInjectMembers;for(const s of t.lazyMembers)Reflect.defineProperty(e.prototype,s.memberName,{enumerable:!0,configurable:!0,get(){let e,t=r.get(this);if(t){if(Reflect.has(t,s.memberName))return t[s.memberName]}else t={},r.set(this,t);return e="symbol"==typeof s.definedClassOrSymbol?n.searchDependencyBySymbol(s.definedClassOrSymbol):n.searchDependencyByClass(s.definedClassOrSymbol),t[s.memberName]=e,e},set(t){"frozen"===o.instance.getInjectableOptions(e).setTo&&c.throwError("29019",`该类 (${e.name}) 的实例已置为frozen，无法对其属性重新赋值！`);let n=r.get(this);n||(n={},r.set(this,n)),n[s.memberName]=t}})}const n=Object.getPrototypeOf(e);n&&this.handleInstanceLazyMembers(n)}handleInstanceStaticMember(e,n,r,s=t){if(s.lazy){let t,s=!1;Reflect.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>(s||(t="symbol"==typeof r?m.instance.searchDependencyBySymbol(r):m.instance.searchDependencyByClass(r),s=!0),t),set(n){"frozen"===o.instance.getInjectableOptions(e).setTo&&c.throwError("29020",`该类 (${e.name}) 的实例已置为frozen，无法对其属性重新赋值！`),t=n,s=!0}})}else"symbol"==typeof r?Reflect.set(e,n,m.instance.searchDependencyBySymbol(r)):Reflect.set(e,n,m.instance.searchDependencyByClass(r))}static get instance(){return d._instance||(d._instance=new d),d._instance}}class y{constructor(){this.dependenciesSearcher=m.instance,this.dependenciesGraph=new p,this.creatingInstanceClassQueue=[],this.isInjecting=!1}createDependency(e,t){let n=!1;this.isInjecting||(this.isInjecting=!0,n=!0);const r=this.createInstance(e,t);return n&&(y._instance=null),r}getCreatingInstanceClass(){if(0!==this.creatingInstanceClassQueue.length)return this.creatingInstanceClassQueue[this.creatingInstanceClassQueue.length-1]}createInstance(e,t){this.checkCircularDependencies(e),this.creatingInstanceClassQueue.push(e);const n=Reflect.getMetadata?.("design:paramtypes",e);n&&this.handleConstructorArgs(t,n,e);try{const n=d.instance;n.handleInstanceLazyMembers(e);const r=new e(...t);switch(n.handleInstanceMembers(e,r),o.instance.getInjectableOptions(e).setTo){case"inextensible":Object.preventExtensions(r);break;case"sealed":Object.seal(r);break;case"frozen":Object.freeze(r)}return this.creatingInstanceClassQueue.pop(),r}catch(t){c.throwError("39001",`依赖注入容器实例化类 "${e?.name}" 出错！\n    ${t?.stack??t}`)}}checkCircularDependencies(e){let t;this.creatingInstanceClassQueue.length>0&&(t=this.creatingInstanceClassQueue[this.creatingInstanceClassQueue.length-1]);const n=this.dependenciesGraph.addNodeAndCheckRing(e,t);if(n){const e=n.map((e=>e.name)).join(" -> ");c.throwError("39002",`检测到循环依赖：${e}`)}}handleConstructorArgs(e,t,n){if(e.length>t.length)c.warn("20001",`为 "${n?.name}" 的构造方法配置的参数过多！`);else if(e.length<t.length){const n=t.length-e.length;for(let t=0;t<n;t++)e.push(s)}const r=o.instance;for(let n=0;n<e.length;n++)if(e[n]===s){if("function"==typeof t[n]&&r.contains(t[n])){e[n]=this.dependenciesSearcher.searchDependencyByClass(t[n]);continue}e[n]=void 0}}static get instance(){return y._instance||(y._instance=new y),y._instance}}class g{constructor(){this.cachedDependenciesMap=new Map,this.cachedDependencyKeysMap=new Map}addDependency(e,t,n){let r=this.cachedDependenciesMap.get(e);r||(r=new WeakMap,this.cachedDependenciesMap.set(e,r)),r.set(n,t)}getDependency(e,t){return this.cachedDependenciesMap.get(e)?.get(t)}removeDependency(e){return this.cachedDependencyKeysMap.delete(e),this.cachedDependenciesMap.delete(e)}addDependencyKey(e,t){this.cachedDependencyKeysMap.set(e,WeakRef?new WeakRef(t):t)}getDependencyKey(e){const t=this.cachedDependencyKeysMap.get(e);if(t)return WeakRef?t.deref():t}static get instance(){return g._instance||(g._instance=new g),g._instance}}class m{searchDependencyByClass(e,t){if(!e)return;const{usingClass:n,usingArgs:r,usingObject:s,afterInstanceCreate:i,afterInstanceFetch:a}=this.getUsingsByConfig(e,t);return s?(a?.(s,!1),s):this.searchDependency(n,r,i,a)}searchDependencyBySymbol(e,t){if(!e)return;const{usingClass:n,usingArgs:r,usingObject:s,afterInstanceCreate:i,afterInstanceFetch:a}=this.getUsingsBySymbolConfig(e,t);return s?(a?.(s,!1),s):this.searchDependency(n,r,i,a)}searchDependency(e,t,n,r){"function"!=typeof e&&c.throwError("29014",`配置使用的Class(${e})无效！`),Array.isArray(t)||c.throwError("29015",`配置的构造方法参数(${t})无效！`),n&&"function"!=typeof n&&c.throwError("29016","配置的afterInstanceCreate必须是函数！"),r&&"function"!=typeof r&&c.throwError("29017","配置的afterInstanceFetch必须是函数！");const s=o.instance.getInjectableOptions(e);let i;switch(s.type){case"singleton":const a=f.instance;i=a.getDependency(e),i?r?.(i,!1):(i=y.instance.createDependency(e,t),a.addDependency(e,i),n?.(i),r?.(i,!0));break;case"cached":const o=g.instance;let u=o.getDependencyKey(e);u?(i=o.getDependency(e,u),r?.(i,!1)):(i=y.instance.createDependency(e,t),u=s.follow?s.follow.call(i,i):i,u||c.throwError("29007",`follow方法的返回值不能为空！\n    class: ${e?.name}, 返回值: ${u}`),"object"!=typeof u&&c.throwError("29008",`follow方法的返回值必须是对象类型！\n    class: ${e?.name}, 返回值: ${u}`),o.addDependencyKey(e,u),o.addDependency(e,i,u),n?.(i),r?.(i,!0));break;default:i=y.instance.createDependency(e,t),n?.(i),r?.(i,!0)}return i}getUsingsByConfig(e,t){let n,r,s,a=t??[],o=e;for(;n!==o;){n=o;const t=u.instance.getConfigMethod(o);if(t){const n=new l(o,a),u=t(n,y.instance.getCreatingInstanceClass());if(u&&u!==i){if(u instanceof e)return{usingObject:u,afterInstanceCreate:n.afterInstanceCreate,afterInstanceFetch:n.afterInstanceFetch};c.throwError("29002",`配置的对象不是 "${e?.name}" 或其子类的实例`)}if(o=n.usingClass,a=n.args,r=n.afterInstanceCreate,s=n.afterInstanceFetch,u===i)return{usingClass:o,usingArgs:a??[],afterInstanceCreate:r,afterInstanceFetch:s}}}return{usingClass:n,usingArgs:a??[],afterInstanceCreate:r,afterInstanceFetch:s}}getUsingsBySymbolConfig(e,t){const n=u.instance.getConfigMethod(e);n||c.throwError("29021",`未找到该Symbol "${e.toString()}" 对应的依赖配置方法！如果您已经定义了方法，请确认该方法会被程序加载到，或者您可以使用registerDepsConfig()方法对其进行加载。`);const r=new l(void 0,t),s=n(r,y.instance.getCreatingInstanceClass());if(s&&s!==i)return{usingObject:s,afterInstanceCreate:r.afterInstanceCreate,afterInstanceFetch:r.afterInstanceFetch};const a=r.usingClass;if(s===i)return{usingClass:a,usingArgs:r.args??[],afterInstanceCreate:r.afterInstanceCreate,afterInstanceFetch:r.afterInstanceFetch};const o=this.getUsingsByConfig(a,r.args);return o.afterInstanceCreate||(o.afterInstanceCreate=r.afterInstanceCreate),o.afterInstanceFetch||(o.afterInstanceFetch=r.afterInstanceFetch),o}static get instance(){return m._instance||(m._instance=new m),m._instance}}function b(t=e){return function(e){(function(e){const t=o.instance;let n=Reflect.getPrototypeOf(e);for(;n;){if("singleton"===t.getInjectableOptions(n)?.type)return!0;n=Reflect.getPrototypeOf(n)}return!1})(e)&&c.throwError("29001",`禁止继承依赖类型为 "singleton" 的类！ 如果您需要单例的子类，请单独在子类上使用 "@Injectable({ type: 'singleton' })"\n    class: ${e.name}`);const n=o.instance;if(n.contains(e)&&c.throwError("29022",`禁止重复设置注入选项！class: ${e.name}`),n.collect(e,t),t.injectOnNew){const t=function(...t){return m.instance.searchDependencyByClass(e,t)},n=Reflect.ownKeys(e);for(const r of n)"length"!==r&&"name"!==r&&Reflect.defineProperty(t,r,Reflect.getOwnPropertyDescriptor(e,r));return t}return e}}function w(e,t,n){const r=Reflect.getMetadata?.("design:type",e,t);r&&o.instance.contains(r)&&d.instance.addInjectMember(e,t,r,n)}function v(e,t,n,r){("function"!=typeof n||o.instance.contains(n))&&d.instance.addInjectMember(e,t,n,r)}function _(e,t,n){const r=Reflect.getMetadata?.("design:type",e,t);r&&o.instance.contains(r)&&d.instance.handleInstanceStaticMember(e,t,r,n)}function M(e,t,n,r){("function"!=typeof n||o.instance.contains(n))&&d.instance.handleInstanceStaticMember(e,t,n,r)}function D(e){return!!e.prototype}var C;Object.create,Object.create;class I{constructor(){this.keyedDependenciesMap=new Map,this.weakKeyedDependenciesMap=new Map}addDependency(e,t,n,r){if(r){"object"!=typeof n&&c.throwError("29018","将非object类型用作了weakKeyedDependenciesMap对象中WeakMap的键！"),this.keyedDependenciesMap.get(e)?.delete(n);let r=this.weakKeyedDependenciesMap.get(e);r||(r=new WeakMap,this.weakKeyedDependenciesMap.set(e,r)),r.set(n,t)}else{"object"==typeof n&&this.weakKeyedDependenciesMap.get(e)?.delete(n);let r=this.keyedDependenciesMap.get(e);r||(r=new Map,this.keyedDependenciesMap.set(e,r)),r.set(n,t)}}getDependency(e,t){let n=this.keyedDependenciesMap.get(e)?.get(t);return n||("object"==typeof t&&(n=this.weakKeyedDependenciesMap.get(e)?.get(t),n)?n:void 0)}containsDependency(e,t){let n=this.keyedDependenciesMap.get(e)?.has(t);return!!n||!("object"!=typeof t||(n=this.weakKeyedDependenciesMap.get(e)?.has(t),!n))}removeDependency(e,t){let n=this.keyedDependenciesMap.get(e)?.delete(t);return!!n||!(n||"object"!=typeof t||(n=this.weakKeyedDependenciesMap.get(e)?.delete(t),!n))}static get instance(){return I._instance||(I._instance=new I),I._instance}}class k{get alreadyBuilt(){return this._alreadyBuilt}setValues(e){this._alreadyBuilt=!0,null!=e&&("object"!=typeof e&&c.throwError("29010","构建值依赖管理器的初始值必须是object类型！"),this.modularValues=e)}patchValue(e,t){"string"!=typeof e&&c.throwError("19001","key必须是string类型！"),this.modularValues||(this.modularValues={});const n=e.split(".");let r=this.modularValues;for(let e=0;e<n.length-1;e++){let t=r[a];t||(t={},r[a]=t);let s=t[n[e]];s||(s={},t[n[e]]=s),r=s}r[n[n.length-1]]=t}takeValue(e){if("string"!=typeof e&&c.throwError("29012","key必须是string类型！"),!this.modularValues)return;const t=e.split(".");let n=this.modularValues;for(let e=0;e<t.length-1;e++)if(n=n?.[a]?.[t[e]],!n)return;return n[t[t.length-1]]}static get instance(){return k._instance||(k._instance=new k),k._instance}}function j(e,t){"string"!=typeof e&&c.throwError("29013","key必须是string类型！");const n=2===arguments.length;return function(r,s){Reflect.defineProperty(r,s,{enumerable:!0,configurable:!0,get(){const r=k.instance.takeValue(e);return null==r&&n?t:r},set(){c.error("21002","被InjectVal()装饰器装饰的属性为只读属性，无法赋值！")}})}}let O=C=class{constructor(){this.#e=I.instance,this.#t=f.instance,this.#t.getDependency(C)&&c.throwError("29003","请通过依赖查找或依赖注入的方式获取MushroomService实例！")}#e;#t;addDependencyWithKey(e,t,n){t||c.throwError("29005",`向Mushroom容器中添加的对象不能为空！\n    class: ${e.name}`),this.#e.addDependency(e,t,n)}addDependencyWithWeakKey(e,t,n){t||c.throwError("29006",`向Mushroom容器中添加的对象不能为空！\n    class: ${e.name}`),this.#e.addDependency(e,t,n,!0)}getDependencyByKey(e,t){return this.#e.getDependency(e,t)}containsDependencyWithKey(e,t){return this.#e.containsDependency(e,t)}removeDependencyByKey(e,t){return this.#e.removeDependency(e,t)}destroyCachedInstance(e){return g.instance.removeDependency(e)}destroySingletonInstance(e){return e===C&&c.throwError("29004","禁止销毁MushroomService实例！"),this.#t.removeDependency(e)}buildValueDepsManager(e){const t=k.instance;return t.alreadyBuilt&&c.throwError("29009","不能重复构建值依赖管理器！"),t.setValues(e),{patchVal:function(e,n){if("string"==typeof e)t.patchValue(e,n);else for(const n of Object.keys(e))t.patchValue(n,e[n])},takeVal:function(...e){if(1===e.length)return t.takeValue(e[0]);const n=[];for(const r of e)n.push(t.takeValue(r));return n},InjectVal:j}}};O=C=function(e,t,n,r){var s,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,n,a):s(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}([b({type:"singleton"}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",[])}()],O);const E=m.instance;function S(...e){return 1===e.length?E.searchDependencyByClass(e[0]):e.map((e=>E.searchDependencyByClass(e)))}function T(e,...t){return E.searchDependencyByClass(e,t)}function x(e,...t){return E.searchDependencyBySymbol(e,t)}function P(t,n=e){delete n.injectOnNew,R(n)(t)}function N(e,t){A(e)(null,null,{value:t})}const R=b,A=function(e){return(t,n,r)=>{u.instance.collect(e,r.value)}},K=function(e,t){const n=arguments.length;return function(r,s){const i=D(r);0===n?i?_(r,s):w(r,s):1===n?"function"==typeof e||"symbol"==typeof e?i?M(r,s,e):v(r,s,e):null==e?i?_(r,s):w(r,s):i?_(r,s,e):w(r,s,e):2===n&&(null==e?i?_(r,s,t):w(r,s,t):i?M(r,s,e,t):v(r,s,e,t))}},z=O,B=s,$=i,F=a;function V(e){}S(z)})(),r})()));